<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sorpresa ‚Äî maquilla & amor</title>
<style>
  :root{
    --bg-a:#fff0f6;
    --accent:#ff5c8d;
    --muted:#7a4a5a;
    --paper:#fff8fb;
    --gold: #ffd27a;
  }
  html,body{height:100%;margin:0;font-family:Inter, "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  body{
    background: radial-gradient(1000px 500px at 10% 10%, #fff6fb 0%, #ffeef7 15%, #fdeff4 35%, #fff 100%);
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    overflow:hidden;
    color:var(--muted);
  }

  /* stage */
  .stage{width:100%;max-width:1120px;padding:20px;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;gap:14px;}
  h1{margin:0;color:var(--accent);font-size:20px}
  p.lead{margin:0;color:#6d3d4a;opacity:.9}

  .center{width:100%;display:flex;align-items:center;justify-content:center;position:relative;padding:18px 0;box-sizing:border-box;}

  /* box container */
  .box-wrap{width:360px;height:260px;perspective:1400px;position:relative;display:flex;align-items:center;justify-content:center}
  .box{
    width:280px;height:200px;position:relative;transform-style:preserve-3d;transition: transform .9s cubic-bezier(.2,.9,.2,1);
  }
  .box.open{transform: translateY(-8px) rotateX(-6deg) rotateY(6deg) scale(1.02);}

  .lid{
    position:absolute;left:0;right:0;margin:auto;top:-12px;width:280px;height:92px;border-radius:14px;
    background: linear-gradient(180deg,#ff9ec7,#ff6fa5);
    box-shadow: 0 18px 44px rgba(160,30,70,0.14);
    transform-origin: center bottom;
    transition: transform .9s cubic-bezier(.2,.9,.2,1);
    z-index:30;display:flex;align-items:flex-end;justify-content:center;padding-bottom:14px;color:white;font-weight:700;
    text-shadow:0 2px 8px rgba(0,0,0,0.06);letter-spacing:.6px;font-size:14px;
  }
  .box.open .lid{transform: rotateX(-150deg) translateY(-12%);}

  .body{
    position:absolute;left:0;right:0;bottom:0;margin:auto;width:280px;height:140px;border-radius:12px;
    background: linear-gradient(180deg,#ffd6e8,#ffb6d6);
    box-shadow:0 20px 48px rgba(140,30,60,0.12);
    z-index:10;display:flex;align-items:center;justify-content:center;overflow:hidden;
  }

  /* floating paper */
  .paper{
    position:absolute;left:50%;top:32%;transform:translateX(-50%) translateY(28px) scale(.98);
    width:78%;min-height:120px;background:linear-gradient(180deg,var(--paper),#fff1f6);
    border-radius:10px;padding:18px;box-shadow:0 18px 40px rgba(80,20,50,0.12);opacity:0;
    transition:all .9s cubic-bezier(.2,.9,.2,1);z-index:25;pointer-events:auto;
  }
  .box.open + .paper{opacity:1;transform:translateX(-50%) translateY(-28px) scale(1);}

  .paper h2{margin:0;font-family:"Dancing Script",cursive;font-size:28px;color:var(--accent);text-align:center}
  .paper .body-txt{margin-top:10px;color:var(--muted);line-height:1.6;font-size:15px;white-space:pre-wrap;max-height:320px;overflow:auto}

  /* flowers / makeup items layer */
  .items-layer{position:absolute;inset:0;z-index:40;pointer-events:none}
  .item-btn{position:absolute;width:56px;height:56px;pointer-events:auto;cursor:pointer;transition:transform .18s ease;outline:none}
  .item-btn:active{transform:scale(.94)}

  /* bubble */
  .bubble{position:fixed;background:rgba(255,255,255,0.98);padding:10px 12px;border-radius:12px;box-shadow:0 12px 30px rgba(120,20,60,0.12);color:#5b2636;font-weight:700;z-index:120;display:none;max-width:260px;text-align:center}

  /* hearts (topmost) */
  .hearts{position:fixed;inset:0;pointer-events:none;z-index:6;overflow:hidden}

  /* fallback audio button */
  #playAudioBtn{position:fixed;bottom:18px;right:18px;background:linear-gradient(90deg,#ff6fa5,#ff9ec7);color:white;border:none;padding:12px 14px;border-radius:12px;box-shadow:0 8px 30px rgba(200,40,100,0.18);font-weight:700;display:none;z-index:220;cursor:pointer}

  /* signature */
  .signature{margin-top:10px;font-weight:700;color:#542435;opacity:0;transform:translateY(6px);transition:all .8s ease}
  .signature.show{opacity:1;transform:translateY(0)}

  /* responsive */
  @media (max-width:520px){
    .box-wrap{width:86%;height:auto}
    .box{width:84%;height:auto}
    .lid{width:84%}
    .body{width:84%}
    .paper{width:90%}
  }
</style>
</head>
<body>
  <div class="stage" role="main" aria-live="polite">
    <h1>Un detalle especial</h1>
    <p class="lead">Abre la caja y descubre un toque inspirado en maquillaje.</p>

    <div class="center" style="width:100%;max-width:980px;">
      <div class="box-wrap" id="boxWrap" tabindex="0" aria-label="Caja sorpresa">
        <div class="box" id="box">
          <div class="lid">¬°Sorpresa!</div>
          <div class="body" aria-hidden="true"></div>
        </div>

        <div class="paper" id="paper" role="region" aria-labelledby="paperTitle">
          <h2 id="paperTitle">Para ti</h2>
          <div class="body-txt" id="paperTxt"> <!-- content typed by JS --> </div>
          <div class="signature" id="signature">‚Äî Con cari√±o, Angello</div>
        </div>

        <div class="items-layer" id="itemsLayer" aria-hidden="false"></div>
      </div>
    </div>

    <div class="hearts" id="hearts"></div>
  </div>

  <div class="bubble" id="bubble" role="status" aria-live="polite"></div>
  <button id="playAudioBtn">Tocar m√∫sica ‚ô´</button>

  <!-- audio (pixabay) -->
  <audio id="bgAudio" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7e69a4fa17.mp3?filename=romantic-piano-ambient-110955.mp3" type="audio/mpeg">
  </audio>

<script>
/* ---------------- CONFIG ---------------- */
const POEM = `He guardado peque√±as luces en esta caja,
peque√±os trazos de luna y polvos de brillo.
Que tu sonrisa, cuando la leas, sea paisaje c√°lido;
que mi voz llegue suave en cada rengl√≥n.

Si alguna vez la noche se siente fr√≠a,
recuerda que hay un latido que te nombra.
Que esta carta te encuentre en horas serenas,
y que el cari√±o que guardo te abrace en lo simple.`;

const ITEM_MESSAGES = [
  "Tu brillo es incomparable ‚ú®",
  "Eres m√°s bella que cualquier paleta üé®",
  "Tu sonrisa ilumina el d√≠a ‚òÄÔ∏è",
  "Me pierdo en tu mirada cada vez üí´",
  "Eres aut√©ntica y preciosa üå∏",
  "Tu sonrisa es mi mejor elecci√≥n üíñ"
];

const ITEM_POS = [
  {left:'8%', top:'14%'}, {left:'78%', top:'10%'},
  {left:'12%', top:'68%'}, {left:'64%', top:'72%'},
  {left:'40%', top:'6%'}, {left:'86%', top:'58%'}
];

/* ---------------- DOM ---------------- */
const box = document.getElementById('box');
const boxWrap = document.getElementById('boxWrap');
const paper = document.getElementById('paper');
const paperTxt = document.getElementById('paperTxt');
const signature = document.getElementById('signature');
const itemsLayer = document.getElementById('itemsLayer');
const heartsLayer = document.getElementById('hearts');
const bubble = document.getElementById('bubble');
const playAudioBtn = document.getElementById('playAudioBtn');
const audio = document.getElementById('bgAudio');

let itemsCreated = false;

/* ---------- Typewriter effect ---------- */
function typeText(text, target, speed=14){
  target.textContent = '';
  let i=0;
  function step(){
    if(i < text.length){
      target.textContent += text.charAt(i);
      i++;
      let delay = speed + Math.random()*18;
      if(text.charAt(i-1) === '.' || text.charAt(i-1) === '\n') delay += 120;
      setTimeout(step, delay);
    } else {
      signature.classList.add('show');
    }
  }
  step();
}

/* ---------- hearts floating ---------- */
let heartsInterval = null;
function startHearts(){
  if(heartsInterval) return;
  heartsInterval = setInterval(()=> {
    const el = document.createElement('div');
    el.textContent = ['üíñ','üíï','‚ù§'][Math.floor(Math.random()*3)];
    el.style.position='fixed';
    el.style.left = (8 + Math.random()*84) + 'vw';
    el.style.bottom = '-10vh';
    el.style.fontSize = (12 + Math.random()*28) + 'px';
    el.style.zIndex = 6;
    el.style.pointerEvents = 'none';
    el.style.animation = `rise ${4 + Math.random()*6}s linear forwards`;
    heartsLayer.appendChild(el);
    setTimeout(()=> el.remove(), 10000);
  }, 420);
}

/* keyframes injection for rise (not in CSS because inline created elements) */
const kf = `@keyframes rise{0%{transform:translateY(0);opacity:1}100%{transform:translateY(-110vh);opacity:0}}`;
const style = document.createElement('style'); style.innerHTML = kf; document.head.appendChild(style);

/* ---------- create interactive items (flowers / makeup icons) ---------- */
function createItems(){
  if(itemsCreated) return;
  itemsCreated = true;
  ITEM_POS.forEach((pos, idx) => {
    const btn = document.createElement('button');
    btn.className = 'item-btn';
    btn.style.left = pos.left;
    btn.style.top = pos.top;
    btn.setAttribute('aria-label','Elemento con mensaje');
    btn.setAttribute('data-msg', ITEM_MESSAGES[idx % ITEM_MESSAGES.length]);
    // inline SVG variations (flower, brush, lipstick)
    const svgns = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgns, 'svg');
    svg.setAttribute('viewBox','0 0 64 64');
    svg.setAttribute('width','56'); svg.setAttribute('height','56');
    // mix shapes: alternate flower and makeup shapes
    if(idx % 3 === 0){
      svg.innerHTML = `<circle cx="32" cy="32" r="6" fill="#FFD166"/><g fill="#FF7AA2"><ellipse cx="32" cy="8" rx="8" ry="14"></ellipse><ellipse cx="32" cy="56" rx="8" ry="14"></ellipse><ellipse cx="10" cy="32" rx="12" ry="8"></ellipse><ellipse cx="54" cy="32" rx="12" ry="8"></ellipse></g>`;
    } else if(idx % 3 === 1){
      // lipstick icon stylized
      svg.innerHTML = `<g transform="translate(6,8)"><rect x="20" y="28" width="10" height="18" rx="3" fill="#6b2b42"></rect><path d="M20 28 C18 20, 30 14, 34 18 C38 22, 28 28, 20 28 Z" fill="#ff6fa5"></path></g>`;
    } else {
      // brush-like
      svg.innerHTML = `<g transform="translate(6,6)"><rect x="4" y="28" width="36" height="8" rx="4" fill="#8c4a5b"></rect><ellipse cx="6" cy="34" rx="6" ry="10" fill="#ffb6d6" transform="rotate(-20 6 34)"/></g>`;
    }
    btn.appendChild(svg);
    itemsLayer.appendChild(btn);

    // entrance animation
    btn.animate([{transform:'translateY(160px) scale(.9)', opacity:0},{transform:'translateY(0) scale(1)', opacity:1}], {duration:900 + Math.random()*700, easing:'cubic-bezier(.2,.9,.2,1)', delay: 120*idx});

    // click handler
    btn.addEventListener('click', (e)=>{
      e.stopPropagation();
      const msg = btn.getAttribute('data-msg') || 'Te quiero';
      showBubble(msg, btn);
      // small pop effect
      btn.animate([{transform:'scale(.96)'},{transform:'scale(1.06)'},{transform:'scale(1)'}], {duration:420, easing:'cubic-bezier(.2,.9,.2,1)'});
    });
  });
}

/* ---------- bubble position near element ---------- */
function showBubble(text, el){
  bubble.textContent = text;
  bubble.style.display = 'block';
  bubble.style.opacity = '1';
  bubble.style.transform = 'scale(.98)';
  // compute position
  const rect = el.getBoundingClientRect();
  const bw = bubble.offsetWidth || 180;
  let left = rect.left + rect.width/2 - bw/2;
  if(left < 8) left = 8;
  if(left + bw > window.innerWidth - 8) left = window.innerWidth - bw - 8;
  bubble.style.left = left + 'px';
  bubble.style.top = (rect.top - 62) + 'px';
  setTimeout(()=> bubble.style.transform = 'scale(1)', 10);
  clearTimeout(bubble.hideTimeout);
  bubble.hideTimeout = setTimeout(()=> bubble.style.display = 'none', 3600);
}

/* ---------- open box automatically ---------- */
function openBox(){
  box.classList.add('open');
  // show paper after small delay
  setTimeout(()=> {
    paper.style.opacity = '1';
    typeText(POEM, paperTxt, 14);
    signature.classList.remove('show');
  }, 600);

  // hearts + items + music
  startHearts();
  createItems();
  // try play audio, fallback show button
  audio.volume = 0.36;
  audio.play().catch(()=> {
    playAudioBtn.style.display = 'block';
  });
}

/* ---------- play button fallback ---------- */
playAudioBtn.addEventListener('click', ()=>{
  audio.play().then(()=> playAudioBtn.style.display='none').catch(()=>{});
});

/* ---------- keyboard accessibility to toggle ---------- */
boxWrap.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' || e.key === ' '){
    if(!box.classList.contains('open')) openBox();
  }
});

/* ---------- auto open on load (instant) ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // open right away (small delay so UI paints)
  setTimeout(()=> openBox(), 360);
});
</script>
</body>
</html>
